generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Brands {
  id   String @id @default(auto()) @map("_id") @db.ObjectId
  name String
}

model Ingredient {
  id              String                     @id @default(auto()) @map("_id") @db.ObjectId
  FC              Float
  IC              Float
  KJ              Int
  Kcal            Int
  calculateby     String
  name            String
  type            String
  technicalSheets TechnicalSheetIngredient[]
}

model Survey {
  id                    String   @id @default(auto()) @map("_id") @db.ObjectId
  canMakeTechnicalSheet String
  consent               Boolean
  created_at            DateTime @db.Date
  email                 String
  knowsImportance       String
  knowsTechnicalSheet   String
  name                  String
  phoneNumber           String
  studentOrProfessional String
  worksInFoodIndustry   Boolean
}

model TechnicalSheet {
  id          String                     @id @default(auto()) @map("_id") @db.ObjectId
  created_at  DateTime                   @db.Date
  dishName    String
  recipeSize  Float
  totalPrice  Float
  ingredients TechnicalSheetIngredient[] // Relação restaurada
  User        User?                      @relation(fields: [userId], references: [id]) // Relação restaurada
  userId      String?                    @db.ObjectId
}

model TechnicalSheetIngredient {
  id               String         @id @default(auto()) @map("_id") @db.ObjectId
  technicalSheet   TechnicalSheet @relation(fields: [technicalSheetId], references: [id])
  technicalSheetId String         @db.ObjectId
  ingredient       Ingredient     @relation(fields: [ingredientId], references: [id])
  ingredientId     String         @db.ObjectId
  finalWeight      Float
  finalPrice       Float

  @@unique([technicalSheetId, ingredientId])
}

model User {
  id             String           @id @default(auto()) @map("_id") @db.ObjectId
  email          String
  password       String
  TechnicalSheet TechnicalSheet[]
}
